# Meta-ecosystem model

The scripts in this repository are used to 1) clean and analyze empirical data collected from streams in Gros Morne National Park and Terra Nova National Park in Newfoundland, Canada and 2) simulate terrestrial disturbance in a meta-ecosystem model of these stream-riparian ecosystems. These files are inteded to make our analyses as transparent and reproducible as possible, and have the stream data openly accessible for further analysis. A thorough description of the collection methods can be found in the appendix of the associated manuscript entitled "Integrating field data and a meta-ecosystem model to study the effects of multiple terrestrial disturbances on small stream ecosystem function". 

The land class data are not publically available, but Forest Resource Inventory shapefiles can be requested from the Newfoundland government, or can be digitized from satellite imagery.

## Data sources  

1) Field collection July-August 2022  
Water quality and stream measurements, found in "data" folder  

2) United States Geological Survey (USGS) invertebrate database  
Vieira, N.K.M. et al. (2016) ‘A Database of Lotic Invertebrate Traits for North America’, U.S. Geological Survey Data Series, 187, pp. 1–15.  
[USGS Database](https://doi.org/10.3133/ds187)  

    Read their data sharing policy [here](https://www.usgs.gov/media/files/casc-data-sharing-policy).

4) CanElevation 5m resolution digital elevation model  
Government of Canada (2022) High Resolution Digital Elevation Model (HRDEM) - CanElevation Series.
[CanElevation HRDEM](https://open.canada.ca/data/en/dataset/957782bf-847c-4644-a757-e383c0057995) 

6) Data sharing agreement with Gros Morne National Park and Terra Nova National Park.
    
7) Data sharing agreement with the Government of Newfoundland and Labrador.

## Methods  
### In situ data  
We collected the in situ data in triplicate at each stream site and took the mean of the three samples. Refer to the manuscript and appendix A for detailed methods.

### Model simulations
After developing a riparian-stream meta-ecosystem model, we used Mathematica to solve for all possible analytical equilibria of the model. We then selected the equilibrium that was locally stable and feasible, and parameterized the model by generating 10,000 random parameter combinations, each within a range from 0-10 (or 0-1 if a proportion). From these we selected the first 1,000 equilibria taht were feasible, locally stable, and where the benthic invertebrate biomass was greater than periphyton biomass. We used these simulations as the "undisturbed" meta-ecosystem to which we created "terrestrial disturbances" by increasing key parameters to simulate tree removal and increased erosion. Refer to the manuscript and Appendix B for further details.

### Quality assurance  
We removed all data below the method detection limit of each *in situ* measurement and lab analysis before statistical analysis. We ensured that there was no correlation between predictor variables in the empirical dataset before developing the general linear models. 

We performed a global sensitivity analysis on each trophic level and productivity metric in the meta-ecosystem model to identify parameters creating the most uncertainty in the model.  

## software and packages
All data processing and analyses for this project were implemented using R (ver. 4.2.2), Mathematica (ver. 13.2.1), and QGIS (ver. 3.26.3).

Packages used:



## repository directory
### Folder 1: data
Empirical data used for statistical analysis (*in situ* data collected from stream sites and shapefiles digitized in QGIS)  
* benthic_invertebrates.csv
* canopy_cover.csv
* channel_measurements.csv
* chlorophyll_a.csv
* doc.csv
* invert_coeficients.csv
* invert_functional_groups.csv
* invert_traits_usgs.csv
* pebble_count.csv
* periphyton_foil.csv
* spatial_data.zip
* surber_sampling.csv
* tn.csv
* tss_filters.csv
* water_chemistry.csv

### Folder 2: scripts
Scripts used for processing and analyzing our *in situ* and geospatial data.  
*  calculating_disturbance_metrics.R
*  correlogram.R
*  global_sensitivity_analysis.R
*  meta_ecosystem_analytical_equilibria.nb
*  simulate_disturbance.R
*  stats_models.R
*  stream_data_cleaning.R

### Folder 3: output
Key files generated by the various scripts, including statistsical analysis of the empirical data and simulations generated by the meta-ecosystem model  
* disturbance_data_large.csv
* disturbance_data_med.csv
* disturbance_data_small.csv
* empirical_glm_results.csv
* empirical_stream_data.csv
* empirical_stream_data_standard_deviations.csv
* param_simulations_stable_10000.csv

## Sharing and accessing the data
This project is licensed under the MIT license, please see the [MIT license web page](https://opensource.org/license/mit/) for details.

## Funding
This work was funded by an NSERC Discovery grant. We would like to thank all the institutions and authors who made their data open source and free to support our work.

## Recommended citation

## Authors
### Scripts
**Hannah Adams** - *Author* - [LinkedIn](https://www.linkedin.com/in/hannah-adams-624122219/), [GitHub](https://github.com/hfadams), [ORCiD](https://orcid.org/0000-0003-2647-8021)

### Manuscript
**Hannah Adams** - *Author* - [LinkedIn](https://www.linkedin.com/in/hannah-adams-624122219/), [GitHub](https://github.com/hfadams), [ORCiD](https://orcid.org/0000-0003-2647-8021)  
**Shawn J. Leroux** - *Co-author* - [GitHub](https://github.com/sjleroux), [ORCiD](https://orcid.org/0000-0001-9580-0294), [website](https://shawnleroux.wixsite.com/lerouxlab)
